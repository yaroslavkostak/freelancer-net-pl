RewriteEngine On
RewriteBase /

# --- Беклінки та мовні версії ---
# УВАГА: Редірект за текстом анкора (anchor) неможливий — сервер отримує лише URL, не текст посилання.
# Налаштовано редіректи за шляхом URL та субдоменом. Якщо беклінки ведуть на різні шляхи (наприклад /ua, /en),
# вони перенаправляються на /ukr/ та /en/. Посилання на голений домен (/) залишаються на польській головній.

# Субдомени → мовні версії (uk., ua. → українська; en. → англійська)
RewriteCond %{HTTP_HOST} ^(uk|ua)\.(.*)$ [NC]
RewriteRule ^(.*)$ https://freelancer.org.pl/ukr/ [R=301,L]
RewriteCond %{HTTP_HOST} ^en\.(.*)$ [NC]
RewriteRule ^(.*)$ https://freelancer.org.pl/en/ [R=301,L]

# Шляхи "українська версія" → /ukr/
Redirect 301 /ua https://freelancer.org.pl/ukr/
Redirect 301 /ukraine https://freelancer.org.pl/ukr/
Redirect 301 /ukrainian https://freelancer.org.pl/ukr/

# Шляхи "англійська версія" → /en/
Redirect 301 /english https://freelancer.org.pl/en/

# Шляхи "німецька версія" → /de/
Redirect 301 /german https://freelancer.org.pl/de/
Redirect 301 /deutsch https://freelancer.org.pl/de/

# Голений домен (/) — без змін, залишається польська головна https://freelancer.org.pl/

# Загальне правило: додавання закритого слеша до всіх URL (крім файлів та кореневого)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_FILENAME} !-d
RewriteCond %{REQUEST_URI} !^/$
RewriteCond %{REQUEST_URI} !/$
RewriteRule ^(.*)$ /$1/ [R=301,L]

# 301 редіректи для старого сайту freelancer.org.pl
Redirect 301 /kontakty https://freelancer.org.pl/contact/
Redirect 301 /polityka-konfidencjalnosti https://freelancer.org.pl/privacy-policy/
Redirect 301 /umovy-vykorystannya https://freelancer.org.pl/terms/
Redirect 301 /terms-of-use https://freelancer.org.pl/terms/
Redirect 301 /privacy https://freelancer.org.pl/privacy-policy/
Redirect 301 /contacts https://freelancer.org.pl/contact/
Redirect 301 /kontakt https://freelancer.org.pl/contact/
Redirect 301 /polityka https://freelancer.org.pl/privacy-policy/
Redirect 301 /umovy https://freelancer.org.pl/terms/
Redirect 301 /regulamin https://freelancer.org.pl/terms/
Redirect 301 /o-nas https://freelancer.org.pl/
Redirect 301 /about https://freelancer.org.pl/
Redirect 301 /uslugi https://freelancer.org.pl/
Redirect 301 /services https://freelancer.org.pl/
Redirect 301 /cennik https://freelancer.org.pl/
Redirect 301 /pricing https://freelancer.org.pl/
# Redirect 301 /blog https://freelancer.org.pl/blog/
# Redirect 301 /artykuly https://freelancer.org.pl/blog/
# Redirect 301 /articles https://freelancer.org.pl/blog/
Redirect 301 /kalkulator https://freelancer.org.pl/
Redirect 301 /calculator https://freelancer.org.pl/
Redirect 301 /podatki https://freelancer.org.pl/
Redirect 301 /taxes https://freelancer.org.pl/
Redirect 301 /tax-calculator https://freelancer.org.pl/
Redirect 301 /tax-calculator/ https://freelancer.org.pl/

# Редіректи для старих файлів
Redirect 301 /contact.tsx https://freelancer.org.pl/contact/
Redirect 301 /privacy-policy.tsx https://freelancer.org.pl/privacy-policy/
Redirect 301 /terms.tsx https://freelancer.org.pl/terms/
Redirect 301 /contact.html https://freelancer.org.pl/contact/
Redirect 301 /privacy-policy.html https://freelancer.org.pl/privacy-policy/
Redirect 301 /terms.html https://freelancer.org.pl/terms/
Redirect 301 /index.html https://freelancer.org.pl/
Redirect 301 /index.php https://freelancer.org.pl/
Redirect 301 /profile.php https://freelancer.org.pl/
Redirect 301 /topic.php https://freelancer.org.pl/
Redirect 301 /index.php/feed https://freelancer.org.pl/
Redirect 301 /blog https://freelancer.org.pl/
Redirect 301 /blog/ https://freelancer.org.pl/
Redirect 301 /kontakt.html https://freelancer.org.pl/contact/
Redirect 301 /kontakt.php https://freelancer.org.pl/contact/
Redirect 301 /polityka.html https://freelancer.org.pl/privacy-policy/
Redirect 301 /polityka.php https://freelancer.org.pl/privacy-policy/
Redirect 301 /umovy.html https://freelancer.org.pl/terms/
Redirect 301 /umovy.php https://freelancer.org.pl/terms/
Redirect 301 /regulamin.html https://freelancer.org.pl/terms/
Redirect 301 /regulamin.php https://freelancer.org.pl/terms/
Redirect 301 /o-nas.html https://freelancer.org.pl/
Redirect 301 /o-nas.php https://freelancer.org.pl/
Redirect 301 /about.html https://freelancer.org.pl/
Redirect 301 /about.php https://freelancer.org.pl/
Redirect 301 /uslugi.html https://freelancer.org.pl/
Redirect 301 /uslugi.php https://freelancer.org.pl/
Redirect 301 /services.html https://freelancer.org.pl/
Redirect 301 /services.php https://freelancer.org.pl/
Redirect 301 /cennik.html https://freelancer.org.pl/
Redirect 301 /cennik.php https://freelancer.org.pl/
Redirect 301 /pricing.html https://freelancer.org.pl/
Redirect 301 /pricing.php https://freelancer.org.pl/
# Redirect 301 /blog.html https://freelancer.org.pl/blog/
# Redirect 301 /blog.php https://freelancer.org.pl/blog/
# Redirect 301 /artykuly.html https://freelancer.org.pl/blog/
# Redirect 301 /artykuly.php https://freelancer.org.pl/blog/
# Redirect 301 /articles.html https://freelancer.org.pl/blog/
# Redirect 301 /articles.php https://freelancer.org.pl/blog/
Redirect 301 /kalkulator.html https://freelancer.org.pl/
Redirect 301 /kalkulator.php https://freelancer.org.pl/
Redirect 301 /calculator.html https://freelancer.org.pl/
Redirect 301 /calculator.php https://freelancer.org.pl/
Redirect 301 /podatki.html https://freelancer.org.pl/
Redirect 301 /podatki.php https://freelancer.org.pl/
Redirect 301 /taxes.html https://freelancer.org.pl/
Redirect 301 /taxes.php https://freelancer.org.pl/



# Редіректи для старих доменів
RewriteCond %{HTTP_HOST} ^(www\.)?buh-online\.pl$ [NC]
RewriteRule ^(.*)$ https://freelancer.org.pl/$1 [R=301,L]

RewriteCond %{HTTP_HOST} ^(www\.)?freelancer\.net\.pl$ [NC]
RewriteRule ^(.*)$ https://freelancer.org.pl/$1 [R=301,L]

# Редірект з www на без www
RewriteCond %{HTTP_HOST} ^www\.(.*)$ [NC]
RewriteRule ^(.*)$ https://%1/$1 [R=301,L]

# Редірект з HTTP на HTTPS
RewriteCond %{HTTPS} off
RewriteRule ^(.*)$ https://%{HTTP_HOST}%{REQUEST_URI} [L,R=301]

# Видалення зайвих слешів (крім кореневого)
RewriteCond %{REQUEST_FILENAME} !-f
RewriteCond %{REQUEST_URI} ^(.+)/$
RewriteRule ^(.+)/$ /$1 [R=301,L]

# Нормалізація URL - перетворення на нижній регістр
RewriteMap lc int:tolower
RewriteCond %{REQUEST_URI} [A-Z]
RewriteRule (.*) ${lc:$1} [R=301,L] 