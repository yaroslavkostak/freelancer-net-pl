# Google Analytics для freelancer.org.pl — покрокова інструкція (українською)

## Що вже є на сайті

- Компонент **`app/analytics.tsx`** підключає Google Analytics (GA4) через `gtag.js`.
- ID вимірювання задається змінною середовища **`NEXT_PUBLIC_GA_MEASUREMENT_ID`** — нічого не потрібно хардкодити в коді.
- Скрипт завантажується з `strategy="afterInteractive"`, щоб не блокувати перше відображення сторінки.

---

## Крок 1. Створити акаунт і ресурс GA4

1. Перейди на [analytics.google.com](https://analytics.google.com/) і увійди з Google-акаунтом.
2. **Адміністратор** (ліва колонка внизу) → **Створити ресурс**.
3. **Назва ресурсу:** наприклад `Freelancer.org.pl`.
4. **Часовий пояс звітів:** `(GMT+01:00) Warsaw`.
5. **Валюта:** `Polish Zloty (PLN)`.
6. Натисни **Далі** → обери **Веб** → **Далі**.
7. **URL веб-потоку:** `https://freelancer.org.pl`.
8. **Назва потоку:** наприклад `Freelancer.org.pl – основний сайт`.
9. Увімкни **Розширені вимірювання** (події прокрутки, кліки на посилання тощо).
10. Натисни **Створити поток**.
11. На екрані з’явиться **ID вимірювання** у форматі `G-XXXXXXXXXX`. Скопіюй його — він потрібен для наступного кроку.

---

## Крок 2. Додати ID у проєкт

### Локально (розробка)

1. У корені проєкту створи файл **`.env.local`** (якщо його ще немає).
2. Додай рядок (підстав свій ID замість `G-XXXXXXXXXX`):

```env
NEXT_PUBLIC_GA_MEASUREMENT_ID=G-XXXXXXXXXX
```

3. Перезапусти dev-сервер (`npm run dev`). Після цього події з localhost будуть потрапляти в GA4 (якщо не використовуєш фільтр за доменом).

### Продакшен (Vercel / Netlify / хостинг)

- **Vercel:** Проєкт → **Settings** → **Environment Variables** → додай `NEXT_PUBLIC_GA_MEASUREMENT_ID` = `G-XXXXXXXXXX` для середовища **Production** (і за бажанням Preview).
- **Netlify:** **Site settings** → **Environment variables** → додай ту саму змінну.
- **Інший хостинг:** вкажи цю змінну в панелі керування (середовище збірки/запуску).

Після наступного деплою аналітика на freelancer.org.pl почне збирати дані.

---

## Крок 3. Перевірити, що дані йдуть

1. У GA4: **Звіти** → **Звіти у реальному часі**.
2. Відкрий у іншій вкладці [https://freelancer.org.pl](https://freelancer.org.pl) і попереходь по сторінках.
3. У звіті мають з’явитися активні користувачі та події (наприклад `page_view`). Якщо ні — перевір, що в коді підставляється саме твій `G-XXXXXXXXXX` і що на продакшені задана змінна `NEXT_PUBLIC_GA_MEASUREMENT_ID`.

**Додатково:** у браузері (F12 → вкладка **Network**) відфільтруй за `google-analytics.com` або `gtag` — мають бути запити з твоїм ID.

---

## Корисні налаштування в GA4

### Фільтр тестового трафіку (рекомендовано)

Щоб не засмічувати звіти переглядами з localhost або тестових доменів:

1. **Адміністратор** → **Потоки даних** → обери свій веб-потік.
2. **Налаштування тегування** → **Визначення конфігурації** (або **Admin** → **Data streams** → **Configure tag settings**).
3. **Визначення конфігурації** → **Створити** → назва, наприклад «Виключити localhost».
4. Умова: **Хост-ім’я** **містить** `localhost` (або тестовий домен).
5. Дія: **Виключити трафік** → **Зберегти**.

Після збереження тестовий трафік не буде потрапляти в основні звіти.

### Цілі (цільові дії)

Можна створити цілі для ключових дій:

1. **Адміністратор** → **Цілі** → **Створити ціль**.
2. Приклади:
   - **Відвідування сторінки контакту:** тип **Відвідування сторінки**, URL містить `/contact/`.
   - **Клік по посиланню inFakt:** тип **Подія**, назва події `click`, параметр посилання містить `infakt`.
   - **Вибір мови:** подія з назвою, наприклад `language_switch`, і параметром мови.

Після збереження цілей їх конверсії будуть у звітах та у сегментах.

### Розширені події (без змін коду)

У **Потік даних** → **Розширені вимірювання** можна увімкнути:

- Прокрутка (90% сторінки).
- Кліки на зовнішні посилання.
- Кліки на посилання для завантаження файлів.
- Відтворення відео (якщо буде плеєр).

Це дає додаткові події без написання коду.

### Експорт у BigQuery (опційно)

Якщо потрібні «сирі» події для власних звітів:

1. **Адміністратор** → **Налаштування продукту** → **Експорт даних у BigQuery**.
2. Прив’яжи проєкт Google Cloud і налаштуй розклад експорту. Це платна опція за використання BigQuery.

---

## Фішки для простого використання

1. **Звіти у реальному часі** — швидко перевірити, що після деплою події доходять.
2. **Сегменти** — у звітах можна додати сегмент «Тільки трафік з Польщі» (країна = Poland) або «Тільки мобільні».
3. **Дослідження** — розділ **Дослідження** дозволяє будувати власні звіти (наприклад, воронка: головна → контакт → подія «відправлено форму»).
4. **Пов’язаний Google Search Console** — у GA4 можна прив’язати Search Console і бачити пошукові запити та кліки прямо в аналітиці.
5. **Один ID на всі мови** — поточний підхід з одним `NEXT_PUBLIC_GA_MEASUREMENT_ID` збирає дані з усіх версій сайту (pl, ukr, en, de). Мову можна аналізувати за шляхом (`/ukr/`, `/en/`, `/de/`) або за подією, якщо додаси її пізніше.

---

## Як видалити ресурси (Properties)

Якщо в обліковому записі накопичилися зайві сайти/проєкти, їх можна видалити так:

1. Відкрий [analytics.google.com](https://analytics.google.com/) → зліва внизу натисни **Адміністратор**.
2. У **лівій колонці** вибери потрібний **обліковий запис** (наприклад «Мої сайти»).
3. У **центральній колонці «Ресурс»** натисни на **назву ресурсу**, який хочеш видалити (не на стрілку — саме на назву), щоб увійти в цей ресурс.
4. Переконайся, що зверху обрано саме той ресурс. Знову **Адміністратор** → у центральній колонці **Налаштування ресурсу** (Resource settings).
5. Прокрути сторінку вниз до блоку **«Перемістити в кошик»** або **«Видалити ресурс»**.
6. Натисни **Перемістити в кошик** (або **Видалити**), підтверди в діалозі. Ресурс переміститься в кошик; через 35 днів він видалиться остаточно.

**Важливо:** На екрані вибору проєктів («Мої сайти», список ресурсів) кнопки видалення немає — це лише вибір. Видалення завжди робиться через **Адміністратор** → потрібний ресурс → **Налаштування ресурсу** → внизу сторінки.

---

## Конфіденційність і RODO

- У політиці конфіденційності варто вказати, що використовується Google Analytics, з якою метою і посилання на політику Google.
- Для суворого дотримання згоди можна підключати GA лише після згоди користувача (cookie consent). Поточна реалізація завантажує скрипт одразу; якщо додаси банер згоди — можна обгорнути рендер `<Analytics />` у умову «згода на аналітику дана».

---

## Підсумок

| Крок | Дія |
|------|-----|
| 1 | Створити ресурс GA4, отримати ID вимірювання `G-XXXXXXXXXX`. |
| 2 | Додати `NEXT_PUBLIC_GA_MEASUREMENT_ID=G-XXXXXXXXXX` у `.env.local` (локально) та у змінні середовища на продакшені. |
| 3 | Перезапустити/задеплоїти і перевірити у «Звіти у реальному часі». |
| 4 | За бажанням: фільтр тестового трафіку, цілі, розширені події, Search Console. |

Після цього аналітика на freelancer.org.pl буде зібрана і готова до простого використання та подальшого налаштування.
